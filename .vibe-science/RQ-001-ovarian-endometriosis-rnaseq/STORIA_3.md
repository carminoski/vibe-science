Capitolo: Pipeline Analitica per Atlante scRNA-seq di Endometriosi e Carcinomi Ovarici1. Introduzione e ObiettiviIl presente studio analizza un atlante trascrittomico a singola cellula composto da 52 campioni (n > 330.000 cellule), comprendenti tessuto endometriosico (OMA/Endo), endometrio eutopico (EuE), tessuto ovarico sano (nOV) e carcinomi ovarici (CCOC, EnOC, LGsOC).L'obiettivo è identificare le alterazioni trascrittomiche condivise tra endometriosi e carcinomi associati, superando le limitazioni computazionali dei workflow tradizionali (R/Seurat) tramite un approccio basato su Python (Scanpy/scVI).2. Ingestione e Standardizzazione dei Dati (Fase 1)2.1 Sfide di EterogeneitàI dati grezzi, scaricati da NCBI GEO, presentavano una notevole eterogeneità di formati:Output standard 10x Genomics (.mtx, .tsv).File HDF5 (.h5).Tabelle di conteggio testuali (.csv, .txt) con orientamenti variabili (geni sulle righe o sulle colonne).Caso Studio GSE111976: Un dataset aggregato di grandi dimensioni (>4GB) che ha richiesto una procedura di pre-splitting basata sui metadati per isolare i singoli campioni biologici.2.2 Pipeline di Caricamento RobustaÈ stata sviluppata una pipeline di ingestione custom in Python per standardizzare tutti i campioni in oggetti AnnData.Mapping Genico: Per garantire la coerenza tra dataset diversi, tutti i nomi dei geni sono stati mappati agli identificativi Ensembl (versione stabile, senza suffisso di versione) utilizzando l'annotazione GENCODE v43. I geni duplicati o ambigui sono stati gestiti tramite una procedura di collasso per somma (sparse matrix multiplication), preservando l'informazione quantitativa.Gestione Errori: Sono stati risolti problemi specifici legati a file .mtx corrotti (valori float in header integer) e a naming non standard dei file, implementando loader flessibili con fallback automatici.Output: Ogni campione è stato salvato individualmente in formato compresso .h5ad.3. Creazione dell'Atlante Unificato e Controllo Qualità (Fase 2 & 2.5)3.1 Merging e Pulizia StrutturaleI 52 oggetti AnnData sono stati concatenati (outer join) in un unico oggetto.Annotazione: A ogni cellula è stato assegnato un sample_id univoco e una categoria biologica (princ_etic_1) basata su una mappatura rigorosa degli ID originali (es. distinguendo accuratamente "OMA" da "carcinOMA").Filtro Geni: Sono stati rimossi i geni espressi in meno di 20 cellule globali per ridurre la dimensionalità spuria.3.2 Rilevamento e Rimozione dei Doppietti (Doublet Removal)Data la dimensione del dataset, la presenza di doppietti (droplet contenenti due cellule) rappresenta un fattore confondente critico. È stata adottata una strategia di consenso conservativo combinando due algoritmi complementari:Scrublet: Eseguito per singolo campione (approccio manifold-based).SOLO (scVI-tools): Eseguito sull'intero dataset utilizzando un modello di Deep Learning (Variational Autoencoder) addestrato per discriminare doppietti sintetici.Criterio di Esclusione: Una cellula è stata rimossa se classificata come doppietta da:Entrambi i metodi (AND logico), con soglia SOLO calibrata sul quantile 95% per campione.OPPURE se presentava uno score di probabilità estremo (>0.90) in almeno uno dei due metodi.Questo approccio ha permesso di rimuovere i doppietti ad alta confidenza preservando la struttura biologica delle popolazioni rare.4. Integrazione e Riduzione Dimensionale (Fase 3)4.1 Normalizzazione e Selezione FeatureNormalizzazione: Scaling globale a 10.000 conteggi per cellula seguito da trasformazione log1p.Feature Selection (HVG): Selezione dei 2.000 geni più variabili utilizzando il metodo seurat_v3 (basato sulla dispersione dei conteggi grezzi), calcolato separatamente per ogni batch (sample_id) per evitare bias di selezione.4.2 Integrazione Batch-Effect (Harmony)Per correggere gli effetti tecnici dovuti ai diversi esperimenti/piattaforme, è stato applicato l'algoritmo Harmony nello spazio delle Componenti Principali (PCA, 30 componenti). Harmony proietta le cellule in uno spazio condiviso, mescolando i batch mantenendo la topologia biologica.4.3 Clustering e VisualizzazioneUMAP: Calcolata sulle componenti principali armonizzate per la visualizzazione 2D.Clustering: Algoritmo di Leiden applicato al grafo dei vicini (k-NN) a diverse risoluzioni (0.5 e 1.0).5. Annotazione dei Tipi Cellulari (Fase 4 - Completata)L'annotazione preliminare ("Macro-annotation") è stata eseguita utilizzando un approccio marker-driven.Sono stati definiti pannelli di geni canonici per le principali popolazioni attese nel microambiente tumorale ed endometriosico:Epiteliali: EPCAM, KRT8, KRT18, KRT19Stromali/Fibroblasti: COL1A1, DCN, PDGFRA, THY1Immuni: PTPRC (CD45)Endoteliali: PECAM1, VWFPer ogni cellula è stato calcolato uno score di espressione per ciascuna firma. La classificazione è stata assegnata in base allo score predominante.6. Roadmap delle Prossime Fasi (Piano Analitico Definitivo)Il workflow prosegue con le seguenti analisi mirate a rispondere ai quesiti clinici della tesi:STEP 5: Sub-clustering Epiteliale (Marker-Guided)Isolamento delle cellule classificate come "Epithelial".Re-clustering ad alta risoluzione.Identificazione dei sottotipi funzionali: Ciliate (FOXJ1, TPPP3), Secretorie (PAX8, MUC16) e stati intermedi.Verifica della presenza di cellule epiteliali maligne (CNV proxy) vs benigne.STEP 6: Trajectory Inference (Pseudotime)Ricostruzione delle traiettorie di differenziamento (es. Secretorie → Ciliate o transizioni patologiche) utilizzando PAGA e Diffusion Pseudotime (DPT).(Opzionale) Utilizzo di scVelo / CellRank se i dati spliced/unspliced lo permettono.STEP 7: Analisi Differenziale (DGE) PseudobulkAggregazione dei conteggi (pseudobulk) per campione e tipo cellulare (es. Epitelio Secretorio).Confronto statistico robusto: Endometriosi (OMA) vs Endometrio Eutopico (EuE) e Carcinomi vs OMA.Identificazione di geni differenzialmente espressi (DEGs) legati all'infiammazione e alla trasformazione neoplastica.STEP 8: Enrichment Analysis (Pathway)Analisi funzionale dei DEGs identificati nello Step 7.Utilizzo dei database GO Biological Process, KEGG e Reactome.Focus su pathways infiammatori (IL6-STAT3, TNF), rimodellamento della matrice e risposta agli estrogeni.STEP 9: Integrazione Avanzata (Opzionale/Premium)Raffinamento dell'integrazione utilizzando scVI (modello generativo profondo) per un embedding latente più informativo, se necessario.STEP 10: Comunicazione Cellula-CellulaUtilizzo di LIANA o Squidpy per inferire le interazioni ligando-recettore.Focus sulle interazioni tra cellule Stromali/Immuni ed Epiteliali (es. segnali pro-infiammatori o angiogenici).STEP 11: Sintesi FinaleProduzione delle figure finali per la tesi (UMAP annotati, Dotplot marcatori, Volcano plot DGE, Network plot interazioni).